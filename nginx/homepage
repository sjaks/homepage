# homepage
# sjaks@github

server {
    # By default, dismiss all traffic
    listen 80 default_server;
    listen [::]:80 default_server;
    access_log /dev/null;
    error_log /dev/null;
    server_tokens off;
    server_name _;
    return 444;
}

server {
    # Render homepage when accessed via the domain
    server_name sjaks.iki.fi;
    charset utf-8;
    root /home/sami/homepage;
    index index.html;

    # Set server limits
    client_body_buffer_size 1k;
    ssl_protocols TLSv1.2 TLSv1.3;
    access_log /dev/null;
    error_log /dev/null;

    # Set headers
    server_tokens off;
    add_header X-Frame-Options "SAMEORIGIN";
    add_header X-XSS-Protection "1; mode=block";
    add_header Strict-Transport-Security "max-age=31536000; includeSubdomains; preload";
    add_header X-Powered-By "<3";

    # Homepage directives
    location / { try_files $uri $uri/ =404; }

    # Define proxy paths to other applications
    location /temperature { proxy_pass http://localhost:10990/; }
    location /headers { proxy_pass http://localhost:6789; }
    location /bonk { proxy_pass http://localhost:1995/; }

    # Define aliases to static resources
    location /demooni { alias /home/sami/apps/demooni; autoindex on; }
    location /kalapuikko { alias /home/sami/apps/vantaankosken-kalapuikko-js; autoindex on; }

    # Disallow access to some paths
    location /nginx { deny all; return 403; }
    location /.git { deny all; return 403; }

    # Define custom error page
    error_page 400 403 404 405 500 501 502 503 504 /error.html;
}
